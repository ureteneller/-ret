<!DOCTYPE html>
<html lang="tr" dir="ltr">
<head>
    
  <meta charset="utf-8" />
 
<meta name="referrer" content="no-referrer-when-downgrade" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1.0, user-scalable=no">
  <title data-i18n="app.title">Ãœreten Eller â€¢ Ana Sayfa</title>
  <meta name="description" content="Ãœreten Eller: El emeÄŸi Ã¼rÃ¼nler, yÃ¶resel lezzetler ve daha fazlasÄ±. Kategorilere gÃ¶z atÄ±n, arayÄ±n, ilan verin." />
  <link rel="icon" href="/assets/icons/favicon.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <style>
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    :root{ scrollbar-gutter: stable; }
    body{
  margin:0;
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:#fff;
  color:#0b1220;
  -webkit-font-smoothing:antialiased;
  overflow-x:hidden;
  overflow-y:scroll;
  }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    .page{
  min-height:100%;
  display:grid;
  grid-template-rows:auto 1fr auto;
  padding-bottom: 90px; /* ALT SABÄ°T REKLAM Ä°Ã‡Ä°N */
}

    .topbar{position:sticky;top:0;z-index:40;backdrop-filter:saturate(140%) blur(8px);background:rgba(255,255,255,.8);border-bottom:1px solid #e5e7eb}
    .topbar-inner{max-width:1200px;margin:0 auto;padding:14px 16px;display:flex;gap:12px;align-items:center;justify-content:space-between;min-width:0}
    .brand{
  display:flex;
  align-items:center;
  gap:14px;
  min-width:0;
  flex:1;
}

    .brand .logo{
  width:70px;
  height:70px;
  border-radius:14px;
  background:#fff url('/assets/icons/favicon.png') center/cover no-repeat;
  box-shadow:0 3px 8px rgba(0,0,0,0.2);
}

    .brand h1{font-size:18px;letter-spacing:.2px;margin:0;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:40vw}
    .actions{display:flex;align-items:center;gap:8px;flex:0 1 auto;flex-wrap:wrap;min-width:0}
    .btn{white-space:nowrap}
    .lang{display:flex;align-items:center;gap:6px;border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;background:#fff}
    .lang select{border:0;background:transparent;font-weight:700;max-width:28ch}

    /* Ãœst kategori Ã§ipleri â€“ yatay kaydÄ±rma */
    #catNav{border-top:1px solid #eee;border-bottom:1px solid #eee;background:#fff}
    .catnav-inner{max-width:1200px;margin:0 auto;padding:8px 16px;display:block;overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch;scrollbar-gutter:stable both-edges}
    .catnav .chip{display:inline-flex;align-items:center;gap:8px;margin-right:8px;border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;background:#fff;font-weight:700;cursor:pointer;white-space:nowrap}
    .catnav .chip:hover{background:#fafafa}
    .catnav .chip.active{color:#111;background:radial-gradient(120% 120% at 0% 0%, rgba(255,255,255,.75), transparent 35%),linear-gradient(180deg, #f7e7b5, #e8c972 40%, #d7b45d 55%, #caa552 80%, #b79343);border:1px solid #b18a37;box-shadow:inset 0 1px 0 rgba(255,255,255,.7), 0 4px 14px rgba(202,165,82,.3)}

    .catdrops{background:#fff}
    .catdrops-inner{max-width:1200px;margin:0 auto;padding:0 16px 8px}
    .catdrops .panel{display:none;border:1px solid #e5e7eb;border-radius:12px;padding:10px;margin:8px 0;background:#fff}
    .catdrops .panel.open{display:block}

    /* Hero */
    .hero{position:relative;border:1px solid #e5e7eb;border-radius:20px;padding:22px 18px;display:block;gap:20px;overflow:hidden;margin:16px auto;max-width:1200px}
    .hero{
  background: linear-gradient(180deg, #f7e7b5, #e8c972 40%, #d7b45d 55%, #caa552 80%, #b79343);
  color: #fff;
  border: none;
}
.hero{
  text-align:center;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
.hero .cta-row{
  justify-content:center;
}

.hero h2,
.hero p {
  color: #fff;
}
.hero h2,
.hero p {
  text-shadow: 0 1px 3px rgba(0,0,0,0.4);
}
    .hero::after{content:"";position:absolute;inset:-60% -40% auto auto;aspect-ratio:1/1;background:radial-gradient(closest-side,rgba(255,215,0,.15),transparent 70%);pointer-events:none}
    .cta-row{display:flex;flex-wrap:wrap;gap:8px}

    /* Buttons */
    .btn{--gold:#caa552;--shine:rgba(255,255,255,.7);--ink:#0b1220;appearance:none;border:0;cursor:pointer;font-weight:800;border-radius:12px;padding:10px 14px;position:relative;isolation:isolate;transition:transform .06s ease, box-shadow .2s ease;user-select:none}
    .btn:active{transform:translateY(1px)}
    .btn.gold{
  color:#fff;
  background:linear-gradient(180deg, #f7e7b5, #e8c972 40%, #d7b45d 55%, #caa552 80%, #b79343);
  border:1px solid #b18a37;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.3), 0 4px 18px rgba(202,165,82,.35);
}
.btn.gold:hover{
  opacity:0.9;
  transform:translateY(-1px);
}
    .btn.ghost{background:#fff;border:1px solid #e5e7eb}

    /* Auth badge */
    .auth-badge{display:flex;align-items:center;gap:10px;padding:6px 10px;border:1px solid #e5e7eb;border-radius:999px}
    .avatar{width:28px;height:28px;border-radius:50%;background:#f3f4f6;overflow:hidden}

    /* ===== MODAL ===== */
    dialog.modal{
      position:fixed;
      inset:0;
      display:none;
      place-items:center;
      background:rgba(0,0,0,.32);
      z-index:60;
      padding:0;
      overflow:hidden;
    }
    dialog[open].modal{ display:grid; }

    .sheet{
      width:min(560px, 96vw);
      max-width:100vw;
      margin:0;
      background:#fff;
      border-radius:18px;
      border:1px solid #e5e7eb;
      box-shadow:0 30px 60px rgba(0,0,0,.15);
      overflow:hidden;
    }
    .sheet header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
      padding:12px 14px;
      border-bottom:1px solid #eee;
      flex-wrap:wrap; /* kÃ¼Ã§Ã¼k ekranda taÅŸma olursa sar */
    }
    .sheet header h3{ margin:0; font-size:18px; }
    .sheet .inner{
      padding:16px;
      max-height:80vh; /* ezilmeyi Ã¶nle */
      overflow:auto;   /* taÅŸanÄ± kaydÄ±r */
    }

    .form{ display:grid; gap:10px; }
    .row2{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
    @media (max-width:560px){ .row2{ grid-template-columns:1fr; } }

    .input{ display:flex; flex-direction:column; gap:6px; min-width:0; }
    .input label{ font-size:12px; color:#6b7280; }
    .input input, .input select{
      border:1px solid #e5e7eb;
      border-radius:10px;
      padding:10px 12px;
      font-size:14px;
      width:100%;
      min-width:0;
    }

    .pw{ position:relative; }
    .pw input{ padding-right:38px; }
    .pw .toggle{
      position:absolute; right:8px; top:50%;
      transform:translateY(-50%);
      border:0; background:transparent; cursor:pointer;
    }

    /* ===== FOOTER ===== */
    /* Ã–deme / GÃ¼venlik bantÄ± (legal Ã¼stÃ¼nde) */
.payments{
  max-width:1200px;
  margin:0 auto 12px;      /* footerâ€™dan Ã¶nce hafif boÅŸluk */
  padding:8px 12px;
}
.payments img{
  width:100%;
  height:auto;
  display:block;
  object-fit:contain;
}
    .legal{ background:#000; color:#fff; }
    .legal .inner{ max-width:1200px; margin:0 auto; padding:16px; }
    .legal .row{ display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .legal .links{ display:flex; flex-wrap:wrap; gap:14px; align-items:center; }

  /* ===== RESPONSIVE ===== */
@media (max-width:768px){
  .topbar-inner{ padding:12px 12px; }
  .catnav-inner{ padding:8px 12px; }

  .hero{
    margin:6px 8px;
    padding:10px 8px;
    text-align:center;
  }
  .hero h2{
    font-size:1rem;
    line-height:1.2;
    margin-bottom:4px;
  }
  .hero p{
    font-size:0.75rem;
    line-height:1.2;
    margin:0 0 6px 0;
  }
  .cta-row{ gap:6px; }

  /* Kart butonlarÄ± kÃ¼Ã§Ã¼k ekranda kÄ±rÄ±lÄ±p alta geÃ§sin */
  .card .actions{ flex-wrap:wrap; }
  .card .actions .btn{
    flex:1 1 100%;
    white-space:normal;
    min-width:0;
  }
}


    /* Kart butonlarÄ± kÃ¼Ã§Ã¼k ekranda kÄ±rÄ±lÄ±p alta geÃ§sin */
    .card .actions{ flex-wrap:wrap; }
    .card .actions .btn{
      flex:1 1 100%;
      white-space:normal;
      min-width:0;
    }
    @media (min-width:481px){
      .card .actions .btn{ flex:1; }
    }

    .actions{ min-width:0; }
    .lang select{ max-width:100%; }

    @media (max-width:520px){
  .topbar-inner{ flex-wrap:wrap; }
  .actions{ flex-basis:100%; justify-content:flex-end; }
  .brand .logo{
    width:65px;
    height:65px;
  }
  .lang{ padding:6px 8px; }
}

    /* ===== Ä°LAN KARTLARI ===== */
    .listings-section{ max-width:1200px; margin:0 auto; padding:16px 12px; }

    .listings-head{display:flex;align-items:center;justify-content:space-between;gap:8px;flex-wrap:wrap}
    .listings-head h3{ margin:0; font-size:18px; }

    .listings-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(260px,1fr)); /* geniÅŸle, mobilde 1 sÃ¼tun */
      gap:12px;
      min-width:0;
    }
    
    @media (max-width:480px){
  .listings-grid{
    grid-template-columns:repeat(2, 1fr); /* mobilde iki ilan yan yana */
  }
}
@media (min-width:481px) and (max-width:900px){
  .listings-grid{
    grid-template-columns:repeat(3, 1fr);
  }
}
@media (min-width:901px){
  .listings-grid{
    grid-template-columns:repeat(4, 1fr);
  }
}

    .card{
      border:1px solid #e5e7eb;
      border-radius:16px;
      overflow:hidden;
      background:#fff;
      display:flex;
      flex-direction:column;
      box-shadow:0 10px 30px rgba(0,0,0,.04);
    }

    .card .ph img{ width:100%; height:auto; }
    .card .ph{
  position:relative;
  width:100%;
  aspect-ratio:1/1; /* kare oran: tÃ¼m resimler eÅŸit boyda gÃ¶rÃ¼nÃ¼r */
  background:#f9f9f9;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card .ph img{
  width:100%;
  height:100%;
  object-fit:cover; /* taÅŸarsa kes, her zaman aynÄ± boyutta */
}

    .card .body{ padding:12px; display:grid; gap:6px; }
    .card .title{ font-weight:700; line-height:1.3; margin:0 0 4px; }
    .price{ font-weight:900; }

    .seller{ display:flex; gap:8px; align-items:center; }
    .seller .av{ width:22px; height:22px; border-radius:50%; background:#eee; overflow:hidden; }
    .seller .av img{ width:100%; height:100%; object-fit:cover; }
    .seller .name{ font-size:12px; }

    .badge{
      border:1px solid #10b981;
      color:#065f46;
      padding:2px 6px;
      border-radius:999px;
      background:#ecfdf5;
      margin-left:auto;
      white-space: nowrap;  
      line-height: 1;       
      display: inline-flex;  
      align-items: center;  
    }

    .card .actions{ display:flex; gap:8px; margin-top:8px; }
    .card .actions .btn{ flex:1; }

    .pill{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid #e5e7eb; border-radius:999px;
      padding:6px 10px; background:#fff;
    }

    .paging{ display:flex; gap:8px; justify-content:center; margin-top:12px; }

    /* Showcase simgesi */
    .ribbon{
      position:absolute; top:8px; left:8px;
      background:#caa552; color:#111; font-weight:900; font-size:11px;
      padding:4px 8px; border-radius:999px;
      border:1px solid #b18a37; box-shadow:0 4px 14px rgba(202,165,82,.25);
    }

    /* ===== BOYUT & DÃœZEN OVERRIDE ===== */
    .hero h2{
      font-size:1.9rem;
      line-height:1.22;
      font-weight:800;
    }
    .hero p{
      font-size:1.0625rem;
      line-height:1.5;
    }
    @media (min-width:768px){
      .hero h2{ font-size:2rem; }
      .hero p{  font-size:1.125rem; }
    }
    
    /* ==== Vitrin Rozeti ==== */
.ribbon {
  position: absolute;
  top: 10px;
  left: 10px;
  background: linear-gradient(135deg, #FFD700, #FFB800);
  color: #fff;
  font-weight: 700;
  font-size: 13px;
  padding: 4px 10px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  z-index: 2;
  animation: shine 2s infinite linear;
}

/* Hafif parlama efekti */
@keyframes shine {
  0%   { box-shadow: 0 0 6px rgba(255,215,0,0.4); }
  50%  { box-shadow: 0 0 14px rgba(255,215,0,0.9); }
  100% { box-shadow: 0 0 6px rgba(255,215,0,0.4); }
}

  </style>
  
</head>
<body>
    
    <!-- QR + Google Play BÃ¶lÃ¼mÃ¼ (DOÄRU YER) -->
<section style="background:#f5f5f5;padding:18px 0;">
  <div style="
      max-width:1200px;
      margin:0 auto;
      padding:0 14px;
      display:flex;
      align-items:center;
      gap:14px;
      flex-wrap:wrap;
  ">
    
    <!-- QR KOD -->
    <img src="/qr-code.png" 
         style="width:90px;height:90px;border-radius:8px;flex-shrink:0;"
         alt="Ãœreten Eller QR">

    <!-- METÄ°N -->
    <div style="flex:1;min-width:180px;">
      <h3 style="margin:0;font-size:18px;font-weight:700;">
        Ãœreten Eller artÄ±k Google Play'de!
      </h3>
      <p style="margin:4px 0 0;font-size:14px;color:#555;">
        QR kodu okutarak uygulamayÄ± hemen indirebilirsin.
      </p>
    </div>

    <!-- GOOGLE PLAY BUTONU -->
    <a href="https://play.google.com/store/apps/details?id=com.ureteneller.app" target="_blank"
       style="display:block;">
      <img src="/google-play-tr.png"
           alt="Google Play"
           style="width:150px;max-width:100%;">
    </a>

  </div>
</section>
  <div class="page">
    <div class="topbar">
      <div class="topbar-inner">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <h1 data-i18n="app.name">Ãœreten Eller</h1>
        </div>
        <div class="actions">
          <div class="lang">
            <span>ğŸŒ</span>
            <select id="langSel" aria-label="Dil">
              <option value="tr" selected>TÃ¼rkÃ§e</option>
              <option value="en">English</option>
              <option value="de">Deutsch</option>
              <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            </select>
          </div>
          <button class="btn gold" id="postBtn" data-i18n="buttons.post">Ä°lan Ver</button>
          <div id="authArea" class="auth-badge" style="display:none">
            <div class="avatar"><img id="uAvatar" alt="" /></div>
            <div id="uName" class="hint">KullanÄ±cÄ±</div>
            <button class="btn ghost" id="signOutBtn" data-i18n="buttons.signout">Ã‡Ä±kÄ±ÅŸ</button>
          </div>
          <button class="btn ghost" id="signInBtn" data-i18n="buttons.signin">GiriÅŸ / KayÄ±t</button>
        </div>
      </div>

      <nav id="catNav" class="catnav" aria-label="Kategoriler">
        <div class="catnav-inner"></div>
      </nav>
      <div id="catDrops" class="catdrops">
        <div class="catdrops-inner"></div>
      </div>
    </div>

    <main>
     <section class="content">
  <div class="hero">
    <h2 id="heroTitle" data-i18n="hero.title">El emeÄŸi & yerel lezzetler tek Ã§atÄ± altÄ±nda</h2>
    <p id="heroDesc" data-i18n="hero.desc">
      Ãœreten kadÄ±nlardan, ev yapÄ±mÄ± lezzetlerden, el iÅŸi tasarÄ±mlardan alÄ±ÅŸveriÅŸ yapÄ±n.
      Konumunuza gÃ¶re arayÄ±n, kategorilerden keÅŸfedin.
    </p>
    <div class="cta-row">
      <button class="btn gold" id="browseBtn" data-i18n="buttons.browse">Kategorileri KeÅŸfet</button>
    </div>
  </div>
</section>

<!-- â¬‡ï¸ Bu scripti YUKARIDAKÄ° section'Ä±n hemen altÄ±na ekle -->
<script>
  const heroMessages = {
    tr: [
      "PayTR ile taksitli sat, peÅŸin al â€” paran Ãœreteneller.com gÃ¼vencesinde!",
      "El emeÄŸini dÃ¼nyaya ulaÅŸtÄ±r, kazancÄ±nÄ± gÃ¼venle al.",
      "GÃ¼venli satÄ±ÅŸÄ±n adresi: Ãœreteneller.com & PayTR!",
      "Evde Ã¼ret, TÃ¼rkiyeâ€™ye sat â€” Ã¶demeni anÄ±nda al!",
      "PayTR korumasÄ± ile her satÄ±ÅŸta iÃ§in rahat olsun.",
      "Ãœreteneller.comâ€™da her satÄ±ÅŸ, %100 gÃ¼venle gerÃ§ekleÅŸir.",
      "KadÄ±n Ã¼reticilerin emeÄŸi, PayTR gÃ¼vencesiyle alÄ±cÄ±da!",
      "Taksitle sat, paranÄ± peÅŸin al â€” sadece Ãœreteneller.comâ€™da!",
      "Ãœreteneller.com & PayTR: EmeÄŸini deÄŸerlendirmenin en gÃ¼venli yolu.",
      "El emeÄŸi kazanca dÃ¶nÃ¼ÅŸÃ¼yor, paran gÃ¼venle hesabÄ±na geÃ§iyor.",
      "Her satÄ±ÅŸÄ±nda PayTR gÃ¼vencesi, her alÄ±ÅŸveriÅŸinde huzur!",
      "Ãœreten kadÄ±nlar iÃ§in gÃ¼Ã§lÃ¼ bir ticaret aÄŸÄ±!",
      "KazancÄ±nÄ± koru, satÄ±ÅŸÄ±nÄ± gÃ¼venle tamamla.",
      "Ãœreteneller.com â€” gÃ¼venli Ã¶deme, mutlu Ã¼retici!",
      "SatÄ±ÅŸ yap, kazancÄ±n anÄ±nda senin olsun â€” PayTR farkÄ±yla!"
    ],
    en: [
      "Sell with installments, get paid instantly â€” your money is safe with PayTR & Ureteneller.com.",
      "Turn your handmade work into income safely.",
      "Secure sales powered by Ureteneller.com and PayTR!",
      "Create, sell, and get paid instantly â€” all under PayTR protection.",
      "Trusted by thousands of women producers across Turkey.",
      "Sell confidently, PayTR protects your earnings.",
      "Every sale on Ureteneller.com is backed by PayTR security.",
      "Installment sales, instant payments â€” stress free!",
      "Your craft, your income, your safety â€” with PayTR.",
      "Shop and sell safely, powered by PayTR and Ureteneller.com.",
      "Payments delivered instantly, safely, globally.",
      "PayTR protection for both buyers and sellers.",
      "Empowering women producers through secure payments.",
      "Your handmade goods, delivered with trust.",
      "Trade with confidence â€” PayTR keeps you safe."
    ],
    de: [
      "Verkaufe mit Ratenzahlung, erhalte dein Geld sofort â€” sicher mit Ãœreteneller.com & PayTR.",
      "Handgemachtes verkaufen, Einkommen sichern!",
      "Jeder Verkauf ist durch PayTR geschÃ¼tzt.",
      "Vertraue auf sichere Zahlungen mit Ãœreteneller.com.",
      "Zahle in Raten, erhalte dein Geld sofort!",
      "Sicherheit bei jedem Verkauf, Dank PayTR.",
      "Deine Arbeit, dein Gewinn, deine Sicherheit.",
      "Sichere Plattform fÃ¼r kreative VerkÃ¤uferinnen!",
      "Verkaufe weltweit â€” PayTR schÃ¼tzt dein Einkommen.",
      "ZuverlÃ¤ssige Zahlungen, zufriedene VerkÃ¤ufer.",
      "PayTR-Schutz fÃ¼r KÃ¤ufer und VerkÃ¤ufer.",
      "Sicherheit und Vertrauen bei jedem GeschÃ¤ft.",
      "Schnelle Auszahlungen, garantierte Sicherheit.",
      "Ãœreteneller.com & PayTR â€” das Vertrauen zÃ¤hlt.",
      "Dein Handwerk verdient sicheren Erfolg."
    ],
    ar: [
      "Ø¨Ø¹ Ø¨Ø§Ù„ØªÙ‚Ø³ÙŠØ· ÙˆØªØ³Ù„Ù… Ø§Ù„Ù…Ø¨Ù„Øº ÙÙˆØ±Ù‹Ø§ â€” Ø£Ù…ÙˆØ§Ù„Ùƒ Ø¨Ø£Ù…Ø§Ù† Ù…Ø¹ Ãœreteneller.com Ùˆ PayTR.",
      "Ù…Ù†ØªØ¬Ø§Øª ÙŠØ¯ÙˆÙŠØ© Ø¨Ø£Ù…Ø§Ù†ØŒ Ø£Ø±Ø¨Ø§Ø­ ÙÙˆØ±ÙŠØ©!",
      "Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø¢Ù…Ù†Ø© Ù…Ø¶Ù…ÙˆÙ†Ø© Ù…Ù† PayTR.",
      "Ø§ØµÙ†Ø¹ØŒ Ø¨ÙØ¹ØŒ ÙˆØ§Ø³ØªÙ„Ù… Ø£Ù…ÙˆØ§Ù„Ùƒ Ø¨Ø«Ù‚Ø©.",
      "Ø­Ù…Ø§ÙŠØ© PayTR ØªØ¶Ù…Ù† Ø­Ù‚ÙˆÙ‚Ùƒ Ø¯Ø§Ø¦Ù…Ù‹Ø§.",
      "Ø«Ù‚Ø© ÙˆØ£Ù…Ø§Ù† ÙÙŠ ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹ ÙˆØ´Ø±Ø§Ø¡.",
      "Ù…Ù†ØµØ© Ãœreteneller.com â€” Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø¢Ù…Ù† Ù„Ù„Ø¥Ø¨Ø¯Ø§Ø¹ ÙˆØ§Ù„Ø±Ø¨Ø­.",
      "Ø¨ÙŠØ¹Ùƒ Ù…Ø¶Ù…ÙˆÙ†ØŒ ÙˆØ±Ø¨Ø­Ùƒ Ù…Ø­Ù…ÙŠ Ù…Ø¹ PayTR.",
      "Ù†Ø¸Ø§Ù… Ø¯ÙØ¹ Ù…ÙˆØ«ÙˆÙ‚ Ù„ÙƒÙ„ Ø§Ù„Ù…Ø¨Ø¯Ø¹ÙŠÙ†.",
      "Ø£Ù…Ø§Ù†Ùƒ Ø£ÙˆÙ„ÙˆÙŠØªÙ†Ø§ ÙÙŠ Ãœreteneller.com.",
      "ØªØ³ÙˆÙ‚ ÙˆØ¨ÙŠØ¹ Ø¨Ø«Ù‚Ø© ØªØ§Ù…Ø© Ù…Ø¹ PayTR.",
      "Ø­Ù„ÙˆÙ„ Ø¯ÙØ¹ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ³Ø±ÙŠØ¹Ø©.",
      "Ø§Ø±Ø¨Ø­ Ø¨Ø£Ù…Ø§Ù† ÙˆØ§Ø·Ù…Ø¦Ù†Ø§Ù†.",
      "ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ© Ø¨ÙŠØ¹ ØªØ­Ù…ÙŠÙ‡Ø§ PayTR.",
      "Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„ÙŠØ¯ÙˆÙŠ + Ø§Ù„Ø£Ù…Ø§Ù† = Ù†Ø¬Ø§Ø­ Ù…Ø¶Ù…ÙˆÙ†!"
    ]
  };

  const heroTextEl = document.getElementById('heroDesc');
  let msgIndex = 0;

  function rotateHeroText() {
    const lang = localStorage.getItem('ue_lang') || 'tr';
    const list = heroMessages[lang] || heroMessages.tr;
    heroTextEl.textContent = list[msgIndex];
    msgIndex = (msgIndex + 1) % list.length;
  }

  rotateHeroText();
  setInterval(rotateHeroText, 5000);
  window.addEventListener('ue:lang', rotateHeroText);
</script>

<!-- SEO Ä°Ã§erik BloÄŸu (Google Botu iÃ§in statik metin) -->
<section style="max-width:1200px;margin:20px auto;padding:16px;line-height:1.7">
  <h2>Ãœreten Eller Nedir?</h2>
  <p>
    Ãœreten Eller, TÃ¼rkiyeâ€™nin dÃ¶rt bir yanÄ±nda el emeÄŸi Ã¼rÃ¼nler ortaya koyan kadÄ±n Ã¼reticileri
    dijital pazar ile buluÅŸturan gÃ¼venli bir e-ticaret platformudur. Ev yapÄ±mÄ± yiyeceklerden
    el iÅŸi tasarÄ±mlara, yÃ¶resel lezzetlerden doÄŸal Ã¼rÃ¼nlere kadar yÃ¼zlerce kategoride alÄ±ÅŸveriÅŸ
    yapÄ±lmasÄ±nÄ± saÄŸlar. Ãœreten Eller, Ã¼retici kadÄ±nlarÄ±n ekonomik hayata katÄ±lmasÄ±nÄ± desteklerken,
    tÃ¼keticilere de gÃ¼venli ve hÄ±zlÄ± alÄ±ÅŸveriÅŸ imkÃ¢nÄ± sunar.
  </p>

  <h3>PayTR GÃ¼vencesi ile GÃ¼venli Ã–deme</h3>
  <p>
    Platform Ã¼zerindeki tÃ¼m Ã¶demeler PayTR gÃ¼vencesi altÄ±ndadÄ±r. SatÄ±cÄ±lar Ã¼rÃ¼nlerini taksitle
    satabilirken, Ã¶demelerini anÄ±nda ve gÃ¼venle alabilir. AlÄ±cÄ±lar ise korumalÄ± Ã¶deme altyapÄ±sÄ±
    sayesinde sorunsuz bir alÄ±ÅŸveriÅŸ deneyimi yaÅŸar.
  </p>

  <h3>Ev Ekonomisine Destek</h3>
  <p>
    Ãœreten Eller, Ã¶zellikle ev ekonomisini desteklemek isteyen kadÄ±n giriÅŸimcilere yeni fÄ±rsatlar
    sunar. Evde Ã¼retilen Ã¼rÃ¼nlerin geniÅŸ kitlelere ulaÅŸmasÄ±nÄ± kolaylaÅŸtÄ±rÄ±r ve yerel Ã¼retimi
    gÃ¼Ã§lendirir. Her satÄ±ÅŸla birlikte Ã¼retici ailelerin gelirine katkÄ± saÄŸlanÄ±r.
  </p>

  <h3>Neden Ãœreten Eller?</h3>
  <ul>
    <li>TÃ¼rkiyeâ€™nin kadÄ±n Ã¼retici odaklÄ± ilk dijital pazarlarÄ±ndan biri</li>
    <li>PayTR gÃ¼venceli Ã¶deme altyapÄ±sÄ±</li>
    <li>Kolay ilan verme ve hÄ±zlÄ± satÄ±ÅŸ imkÃ¢nÄ±</li>
    <li>YÃ¶resel ve el yapÄ±mÄ± Ã¼rÃ¼nlere eriÅŸim</li>
    <li>GÃ¼venli alÄ±ÅŸveriÅŸ ve satÄ±cÄ± doÄŸrulama sistemi</li>
  </ul>
</section>

      <!-- Yeni Ä°lanlar -->
      <section class="listings-section">
        <div class="listings-head">
          <h3 data-i18n="list.title">Yeni Ä°lanlar</h3>
          <div class="pill" id="listInfo" data-i18n="list.loading">YÃ¼kleniyorâ€¦</div>
        </div>
        <div class="listings-grid" id="listGrid" aria-live="polite"></div>
        <div class="paging">
          <button class="btn ghost" id="prevPage" disabled data-i18n="buttons.prev">â€¹ Ã–nceki</button>
          <button class="btn ghost" id="nextPage" disabled data-i18n="buttons.next">Sonraki â€º</button>
        </div>
      </section>
       </main>


    <!-- Ã–deme / GÃ¼venlik LogolarÄ± -->
    <section class="payments" aria-label="Ã–deme ve gÃ¼venlik">
      <img src="/assets/img/paytr.logo.png"
           alt="Visa, MasterCard, TROY, PayTR, 256-Bit SSL"
           loading="lazy">
    </section>

    <footer class="legal">

      <div class="inner">
        <div class="row">
          <div class="links">
            <a href="/legal/kullanim-sartlari.html" data-i18n="legal.tos">KullanÄ±m ÅartlarÄ±</a>
            <a href="/legal/gizlilik-politikasi.html" data-i18n="legal.privacy">Gizlilik PolitikasÄ±</a>
            <a href="/legal/kvkk-aydinlatma.html" data-i18n="legal.kvkk">KVKK AydÄ±nlatma</a>
            <a href="/legal/topluluk-kurallari.html" data-i18n="legal.community">Topluluk KurallarÄ±</a>
            <a href="/legal/yasakli-urunler.html" data-i18n="legal.prohibited">YasaklÄ± ÃœrÃ¼nler</a>
            <a href="/legal/mesafeli-satis-sozlesmesi.html" data-i18n="legal.distance">Mesafeli SatÄ±ÅŸ</a>
            <a href="/legal/on-bilgilendirme-formu.html" data-i18n="legal.preinfo">Ã–n Bilgilendirme</a>
            <a href="/legal/teslimat-iade-iptal.html" data-i18n="legal.delivery">Teslimat/Ä°ade</a>
            <a href="/legal/iletisim-impressum.html" data-i18n="legal.contact">Ä°letiÅŸim</a>
          </div>
          <div class="hint">Â© <span id="y"></span> <span data-i18n="app.name">Ãœreten Eller</span></div>
        </div>
      </div>
    </footer>
  </div>
  
  <!-- ===== Auth Modal ===== -->
  <dialog class="modal" id="authModal" aria-labelledby="authTitle">
    <div class="sheet">
      <header>
        <h3 id="authTitle" data-i18n="auth.title">GiriÅŸ Yap / KayÄ±t Ol</h3>
        <button class="btn ghost" data-close aria-label="Kapat">âœ•</button>
      </header>
      <div class="inner">
        <div class="form" style="margin-bottom:16px">
          <div class="input"><label for="li_email" data-i18n="fields.email">E-posta</label><input id="li_email" type="email" placeholder="ornek@mail.com" autocomplete="username"/></div>
          <div class="input pw"><label for="li_pass" data-i18n="fields.password">Åifre</label><input id="li_pass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password"/><button class="toggle" data-toggle="li_pass" aria-label="Åifreyi gÃ¶ster">ğŸ‘ï¸</button></div>
          <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn gold" id="loginBtn" data-i18n="buttons.login">GiriÅŸ Yap</button>
              <button class="btn ghost" id="forgotBtn" type="button" data-i18n="buttons.forgot">Åifremi Unuttum</button>
            </div>
            <button class="btn gold" id="googleBtn" type="button" aria-label="Google" data-i18n="buttons.google">Google ile GiriÅŸ</button>
          </div>
        </div>
        <hr style="border:0;border-top:1px solid #eee;margin:8px 0 14px">
        <details>
          <summary style="cursor:pointer;font-weight:700" data-i18n="register.summary">HesabÄ±n yok mu? KayÄ±t ol</summary>
          <div class="form" style="margin-top:10px">
            <div class="row2">
              <div class="input"><label for="su_username" data-i18n="fields.username">KullanÄ±cÄ± AdÄ±</label><input id="su_username" maxlength="24" placeholder="@kullanici"/></div>
              <div class="input"><label for="su_name" data-i18n="fields.fullname">Ad Soyad</label><input id="su_name" placeholder="AdÄ±nÄ±z SoyadÄ±nÄ±z"/></div>
            </div>
            <div class="row2">
              <div class="input"><label for="su_province" data-i18n="fields.province">Ä°l</label>
                <select id="su_province"></select>
              </div>
              <div class="input"><label for="su_district" data-i18n="fields.district">Ä°lÃ§e</label><input id="su_district" placeholder="Ä°lÃ§eniz"/></div>
            </div>
            <div class="row2">
              <div class="input"><label for="su_email" data-i18n="fields.email">E-posta</label><input id="su_email" type="email" placeholder="ornek@mail.com" autocomplete="email"/></div>
              <div class="input pw"><label for="su_pass" data-i18n="fields.password">Åifre</label><input id="su_pass" type="password" placeholder="En az 6 karakter" autocomplete="new-password"/><button class="toggle" data-toggle="su_pass" aria-label="Åifreyi gÃ¶ster">ğŸ‘ï¸</button></div>
            </div>
            <div class="input pw"><label for="su_pass2" data-i18n="fields.password2">Åifre (Tekrar)</label><input id="su_pass2" type="password" placeholder="Åifreyi tekrar yazÄ±n" autocomplete="new-password"/><button class="toggle" data-toggle="su_pass2" aria-label="Åifreyi gÃ¶ster">ğŸ‘ï¸</button></div>
            <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap">
              <button class="btn gold" id="registerBtn" data-i18n="buttons.register">KayÄ±t Ol</button>
              <div class="hint" data-i18n="hints.verify">KayÄ±tla birlikte <strong>mail doÄŸrulama</strong> gÃ¶nderilir. Gelen kutusu ve <strong>SPAM</strong> klasÃ¶rÃ¼nÃ¼ kontrol edin.</div>
            </div>
          </div>
        </details>
      </div>
    </div>
  </dialog>

  <!-- ===== Listing Detail Modal ===== -->
  <dialog class="modal" id="listingModal" aria-labelledby="listingTitle">
    <div class="sheet">
      <header>
        <h3 id="listingTitle" data-i18n="listing.title">Ä°lan DetayÄ±</h3>
        <button class="btn ghost" data-close-listing aria-label="Kapat">âœ•</button>
      </header>
      <div class="inner" id="listingBody"></div>
    </div>
  </dialog>

  <!-- Firebase init -->
  <script type="module" src="/firebase-init.js"></script>

  <script type="module">
      import {
  getAuth,
  onAuthStateChanged,
  signInWithEmailAndPassword,
  signInWithPopup,
  GoogleAuthProvider,
  createUserWithEmailAndPassword,
  sendEmailVerification,
  updateProfile,
  sendPasswordResetEmail,
  signOut,
  fetchSignInMethodsForEmail,   // ğŸŸ¡ KULLANICI KATMANI KONTROLÃœ Ä°Ã‡Ä°N EKLENDÄ°
  linkWithCredential,           // ğŸŸ¡ Google â†” manuel hesap birleÅŸtirme
  EmailAuthProvider             // ğŸŸ¡ Åifre ile birleÅŸtime iÃ§in gerekli
} from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js';

    import {
  getFirestore, doc, setDoc, getDoc, serverTimestamp
} from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js';

const db = (self.__fb?.db) || getFirestore();

/** users/{uid} dokÃ¼manÄ±nÄ± oluÅŸturur/gÃ¼nceller (idempotent) */
async function saveUserProfile(user, form = {}) {
  if (!user) return;
  const uid = user.uid;

  // mevcut mu?
  let exists = false;
  try {
    const s = await getDoc(doc(db, 'users', uid));
    exists = s.exists();
  } catch {}

  const payload = {
    uid,
    email: user.email || '',
    displayName: (form.name || user.displayName || '').toString().trim(),
    username: (form.username || '').toString().trim(),
    province: form.province || '',
    city: form.city || form.province || '',
    district: form.district || '',
    phoneNumber: user.phoneNumber || '',
    photoURL: user.photoURL || '',
    emailVerified: !!user.emailVerified,
    providerIds: (user.providerData || []).map(p => p.providerId),
    // ilk oluÅŸturuluyorsa varsayÄ±lan roller
    ...(exists ? {} : { roles: { seller: true, buyer: true }, createdAt: serverTimestamp() }),
    updatedAt: serverTimestamp()
  };

  await setDoc(doc(db, 'users', uid), payload, { merge: true });
}

/** GiriÅŸte profil yoksa sessizce oluÅŸturur; varsa doÄŸrulama bayraÄŸÄ±nÄ± senkronlar */
async function ensureUserDoc(user) {
  if (!user) return;
  try {
    const ref = doc(db, 'users', user.uid);
    const snap = await getDoc(ref);
    if (!snap.exists()) {
      await saveUserProfile(user, {});
    } else if (snap.data()?.emailVerified !== !!user.emailVerified) {
      await setDoc(ref, { emailVerified: !!user.emailVerified, updatedAt: serverTimestamp() }, { merge: true });
    }
  } catch {}
}

/** Google giriÅŸinden sonra province/district yoksa hÄ±zlÄ±ca al */
async function promptLocationIfMissingAndSave(user, { onDone } = {}) {
  try {
    const ref = doc(db, 'users', user.uid);
    const snap = await getDoc(ref);
    const d = snap.exists() ? snap.data() : {};
    const hasCity = (d?.province && String(d.province).trim()) || (d?.city && String(d.city).trim());
    const hasDistrict = d?.district && String(d.district).trim();

    if (hasCity && hasDistrict) { onDone?.(); return; }

    // Basit, baÄŸÄ±msÄ±z mini modal
    const wrap = document.createElement('div');
    wrap.style.cssText = 'position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.35);z-index:9999';
    wrap.innerHTML = `
      <div style="width:min(520px,96vw);background:#fff;border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 30px 60px rgba(0,0,0,.15);overflow:hidden">
        <div style="padding:12px 14px;border-bottom:1px solid #eee;font-weight:800">Konumunu tamamla</div>
        <div style="padding:14px;display:grid;gap:10px">
          <div style="font-size:14px;color:#374151">Ä°lanlar ve Ã¶neriler iÃ§in il / ilÃ§e bilgin gerekli.</div>
          <div style="display:grid;gap:8px">
            <label style="font-size:12px;color:#6b7280">Ä°l</label>
            <input id="pl_prov" placeholder="Ã–rn: Ä°stanbul" style="border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;font-size:14px">
          </div>
          <div style="display:grid;gap:8px">
            <label style="font-size:12px;color:#6b7280">Ä°lÃ§e</label>
            <input id="pl_dist" placeholder="Ã–rn: KadÄ±kÃ¶y" style="border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px;font-size:14px">
          </div>
          <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:6px;flex-wrap:wrap">
            <button id="pl_skip" class="btn ghost" style="border:1px solid #e5e7eb;border-radius:12px;padding:10px 14px;font-weight:800;background:#fff;cursor:pointer">Sonra</button>
            <button id="pl_save" class="btn gold" style="border:1px solid #b18a37;border-radius:12px;padding:10px 14px;font-weight:800;background:linear-gradient(180deg,#f7e7b5,#e8c972 40%,#d7b45d 55%,#caa552 80%,#b79343);cursor:pointer">Kaydet</button>
          </div>
        </div>
      </div>
    `;
    document.body.appendChild(wrap);

    const prov = wrap.querySelector('#pl_prov');
    const dist = wrap.querySelector('#pl_dist');
    const bSave = wrap.querySelector('#pl_save');
    const bSkip = wrap.querySelector('#pl_skip');

    bSkip.addEventListener('click', () => { wrap.remove(); onDone?.(); });

    bSave.addEventListener('click', async () => {
      const p = (prov.value || '').trim();
      const di = (dist.value || '').trim();
      if (!p || !di) { alert('LÃ¼tfen il ve ilÃ§e giriniz.'); return; }
      try {
        await saveUserProfile(user, {
          province: p, district: di
        });
      } catch {}
      wrap.remove();
      onDone?.();
    });
  } catch {
    onDone?.();
  }
}

// ğŸ”’ Email doÄŸrulamasÄ± yapÄ±lmadan /home.html iÃ§eriÄŸi gÃ¶rÃ¼ntÃ¼lenemesin
function guardHomePage(){
  const auth = getAuth();
  onAuthStateChanged(auth, async (u)=>{
    // hiÃ§ giriÅŸ yoksa â†’ hiÃ§bir panel aÃ§ma
    if(!u){
      return;
    }

    // email/ÅŸifre ile giriÅŸ yaptÄ±ysa ve doÄŸrulanmadÄ±ysa â†’ iÃ§eriÄŸi kilitle
    const usesPassword = u.providerData?.some(p=>p.providerId==='password');
    await u.reload();
    if (usesPassword && !u.emailVerified){
      try { await sendEmailVerification(u); } catch {}
      // SayfayÄ± kilitle ve kullanÄ±cÄ±ya doÄŸrulama uyarÄ±sÄ± gÃ¶ster
      document.querySelector('main')?.setAttribute('inert','');
      document.querySelector('main').style.filter = 'blur(4px)';
      if (!document.getElementById('verifyBanner')){
        const div = document.createElement('div');
        div.id = 'verifyBanner';
        div.style.cssText = 'max-width:1200px;margin:12px auto;padding:12px;border:1px solid #f59e0b;background:#fff7ed;border-radius:12px';
        div.innerHTML = currentLang==='en'
          ? '<strong>Verify your email</strong> to access this page. After clicking the link in your email, return here and press â€œI verifiedâ€. <button class="btn gold" id="iVerified">I verified</button>'
          : '<strong>Bu sayfaya eriÅŸmek iÃ§in e-postanÄ±zÄ± doÄŸrulayÄ±n.</strong> E-postadaki linke tÄ±kladÄ±ktan sonra buraya dÃ¶nÃ¼p â€œDoÄŸruladÄ±mâ€a basÄ±n. <button class="btn gold" id="iVerified">DoÄŸruladÄ±m</button>';
        document.querySelector('.topbar')?.after(div);
        document.getElementById('iVerified')?.addEventListener('click', async ()=>{
          await u.reload();
          if (u.emailVerified){
            document.querySelector('main')?.removeAttribute('inert');
            document.querySelector('main').style.filter = '';
            div.remove();
          } else {
            alert(currentLang==='en'
              ? 'Still not verified. Please check your inbox/SPAM.'
              : 'HÃ¢lÃ¢ doÄŸrulanmadÄ±. LÃ¼tfen gelen kutusu/Spam klasÃ¶rÃ¼nÃ¼ kontrol edin.');
          }
        });
      }
      // openAuth?.();  â† kaldÄ±rÄ±ldÄ±, otomatik aÃ§ma yok
      return;
    }

    // DoÄŸrulanmÄ±ÅŸ â†’ sayfa serbest
    document.querySelector('main')?.removeAttribute('inert');
    document.querySelector('main').style.filter = '';
  });
}
guardHomePage();

    /* ===== i18n â€“ Metinler (KATEGORÄ°LERE DOKUNMADAN) ===== */
    const I18N = {
      tr:{'app.title':'Ãœreten Eller â€¢ Ana Sayfa','app.name':'Ãœreten Eller',
          'hero.title':'El emeÄŸi & yerel lezzetler tek Ã§atÄ± altÄ±nda',
          'hero.desc':'Ãœreten kadÄ±nlardan, ev yapÄ±mÄ± lezzetlerden, el iÅŸi tasarÄ±mlardan alÄ±ÅŸveriÅŸ yapÄ±n. Konumunuza gÃ¶re arayÄ±n, kategorilerden keÅŸfedin.',
          'buttons.post':'Ä°lan Ver','buttons.signin':'GiriÅŸ / KayÄ±t','buttons.signout':'Ã‡Ä±kÄ±ÅŸ','buttons.browse':'Kategorileri KeÅŸfet',
          'buttons.login':'GiriÅŸ Yap','buttons.forgot':'Åifremi Unuttum','buttons.google':'Google ile GiriÅŸ','buttons.register':'KayÄ±t Ol',
          'buttons.prev':'â€¹ Ã–nceki','buttons.next':'Sonraki â€º','buttons.order':'SipariÅŸ Ver','buttons.message':'SatÄ±cÄ±ya Yaz',
          'fields.email':'E-posta','fields.password':'Åifre','fields.password2':'Åifre (Tekrar)','fields.username':'KullanÄ±cÄ± AdÄ±','fields.fullname':'Ad Soyad','fields.province':'Ä°l','fields.district':'Ä°lÃ§e',
          'auth.title':'GiriÅŸ Yap / KayÄ±t Ol','register.summary':'HesabÄ±n yok mu? KayÄ±t ol',
          'hints.verify':'KayÄ±tla birlikte <strong>mail doÄŸrulama</strong> gÃ¶nderilir. Gelen kutusu ve <strong>SPAM</strong> klasÃ¶rÃ¼nÃ¼ kontrol edin.',
          'list.title':'Yeni Ä°lanlar','list.loading':'YÃ¼kleniyorâ€¦','list.range':'{start}-{end} / {total}',
          'legal.tos':'KullanÄ±m ÅartlarÄ±','legal.privacy':'Gizlilik PolitikasÄ±','legal.kvkk':'KVKK AydÄ±nlatma','legal.community':'Topluluk KurallarÄ±','legal.prohibited':'YasaklÄ± ÃœrÃ¼nler','legal.distance':'Mesafeli SatÄ±ÅŸ','legal.preinfo':'Ã–n Bilgilendirme','legal.delivery':'Teslimat/Ä°ade','legal.contact':'Ä°letiÅŸim',
          'listing.title':'Ä°lan DetayÄ±','seller.verified':'OnaylÄ±','seller.default':'SatÄ±cÄ±','ribbon.showcase':'Vitrin'},
      en:{'app.title':'Ureten Eller â€¢ Home','app.name':'Ureten Eller',
          'hero.title':'Handmade & local delights in one place',
          'hero.desc':'Shop from women producers, homemade delicacies, and crafts. Search by location or browse categories.',
          'buttons.post':'Post Listing','buttons.signin':'Sign In / Register','buttons.signout':'Sign Out','buttons.browse':'Browse Categories',
          'buttons.login':'Sign In','buttons.forgot':'Forgot Password','buttons.google':'Continue with Google','buttons.register':'Register',
          'buttons.prev':'â€¹ Previous','buttons.next':'Next â€º','buttons.order':'Order','buttons.message':'Message Seller',
          'fields.email':'Email','fields.password':'Password','fields.password2':'Password (Repeat)','fields.username':'Username','fields.fullname':'Full Name','fields.province':'Province','fields.district':'District',
          'auth.title':'Sign In / Register','register.summary':'No account? Create one',
          'hints.verify':'A <strong>verification email</strong> will be sent. Please check your inbox and <strong>SPAM</strong>.',
          'list.title':'New Listings','list.loading':'Loadingâ€¦','list.range':'{start}-{end} of {total}',
          'legal.tos':'Terms of Use','legal.privacy':'Privacy Policy','legal.kvkk':'KVKK Notice','legal.community':'Community Guidelines','legal.prohibited':'Prohibited Items','legal.distance':'Distance Sales','legal.preinfo':'Pre-Information','legal.delivery':'Delivery/Returns','legal.contact':'Contact',
          'listing.title':'Listing Detail','seller.verified':'Verified','seller.default':'Seller','ribbon.showcase':'Showcase'},
      de:{'app.title':'Ureten Eller â€¢ Startseite','app.name':'Ureten Eller',
          'hero.title':'Handgemachtes & lokale KÃ¶stlichkeiten an einem Ort',
          'hero.desc':'Kaufen Sie bei Produzentinnen, Hausmannskost und Handarbeiten. Nach Standort suchen oder Kategorien entdecken.',
          'buttons.post':'Anzeige aufgeben','buttons.signin':'Anmelden / Registrieren','buttons.signout':'Abmelden','buttons.browse':'Kategorien Entdecken',
          'buttons.login':'Anmelden','buttons.forgot':'Passwort Vergessen','buttons.google':'Mit Google Fortfahren','buttons.register':'Registrieren',
          'buttons.prev':'â€¹ ZurÃ¼ck','buttons.next':'Weiter â€º','buttons.order':'Bestellen','buttons.message':'Nachricht an VerkÃ¤ufer',
          'fields.email':'E-Mail','fields.password':'Passwort','fields.password2':'Passwort (Wiederholen)','fields.username':'Benutzername','fields.fullname':'VollstÃ¤ndiger Name','fields.province':'Provinz','fields.district':'Bezirk',
          'auth.title':'Anmelden / Registrieren','register.summary':'Kein Konto? Registrieren',
          'hints.verify':'Eine <strong>BestÃ¤tigungs-E-Mail</strong> wird gesendet. PrÃ¼fen Sie Posteingang und <strong>SPAM</strong>.',
          'list.title':'Neue Anzeigen','list.loading':'LÃ¤dtâ€¦','list.range':'{start}-{end} von {total}',
          'legal.tos':'Nutzungsbedingungen','legal.privacy':'Datenschutz','legal.kvkk':'KVKK Hinweis','legal.community':'Community-Regeln','legal.prohibited':'Verbotene Artikel','legal.distance':'Fernabsatz','legal.preinfo':'Vorabinfo','legal.delivery':'Lieferung/RÃ¼ckgabe','legal.contact':'Kontakt',
          'listing.title':'Anzeigedetails','seller.verified':'Verifiziert','seller.default':'VerkÃ¤ufer','ribbon.showcase':'Schaufenster'},
      ar:{'app.title':'Ø£ÙÙ†ØªØ¬Øª Ø§Ù„Ø£ÙŠØ§Ø¯ÙŠ â€¢ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©','app.name':'Ø£ÙÙ†ØªØ¬Øª Ø§Ù„Ø£ÙŠØ§Ø¯ÙŠ',
          'hero.title':'Ù…Ù†ØªØ¬Ø§Øª ÙŠØ¯ÙˆÙŠØ© ÙˆÙ…Ø£ÙƒÙˆÙ„Ø§Øª Ù…Ø­Ù„ÙŠØ© ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯',
          'hero.desc':'ØªØ³ÙˆÙ‘Ù‚ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬ÙŠÙ† ÙˆØ§Ù„Ù…Ù†ØªÙØ¬Ø§Øª ÙˆØ§Ù„Ù…Ø£ÙƒÙˆÙ„Ø§Øª Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© ÙˆØ§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ÙŠØ¯ÙˆÙŠØ©. Ø§Ø¨Ø­Ø« Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ùˆ ØªØµÙØ­ Ø§Ù„ÙØ¦Ø§Øª.',
          'buttons.post':'Ø£Ù†Ø´Ø¦ Ø¥Ø¹Ù„Ø§Ù†Ù‹Ø§','buttons.signin':'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯','buttons.signout':'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬','buttons.browse':'Ø§Ø³ØªÙƒØ´Ù Ø§Ù„ÙØ¦Ø§Øª',
          'buttons.login':'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„','buttons.forgot':'Ù†Ø³ÙŠØª ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','buttons.google':'ØªØ§Ø¨Ø¹ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Google','buttons.register':'Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨',
          'buttons.prev':'â€¹ Ø§Ù„Ø³Ø§Ø¨Ù‚','buttons.next':'Ø§Ù„ØªØ§Ù„ÙŠ â€º','buttons.order':'Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†','buttons.message':'Ø±Ø§Ø³Ù„ Ø§Ù„Ø¨Ø§Ø¦Ø¹',
          'fields.email':'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ','fields.password':'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','fields.password2':'ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±','fields.username':'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…','fields.fullname':'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„','fields.province':'Ø§Ù„ÙˆÙ„Ø§ÙŠØ©','fields.district':'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©',
          'auth.title':'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨','register.summary':'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ Ø£Ù†Ø´Ø¦ ÙˆØ§Ø­Ø¯Ù‹Ø§',
          'hints.verify':'Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ <strong>Ø¨Ø±ÙŠØ¯ ØªØ­Ù‚Ù‚</strong>. Ø§ÙØ­Øµ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„ÙˆØ§Ø±Ø¯ Ùˆ<strong>Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø²Ø¹Ø¬Ø©</strong>.',
          'list.title':'Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©','list.loading':'Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„â€¦','list.range':'{start}-{end} Ù…Ù† {total}',
          'legal.tos':'Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…','legal.privacy':'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©','legal.kvkk':'Ø¥Ø´Ø¹Ø§Ø± KVKK','legal.community':'Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹','legal.prohibited':'Ù…ÙˆØ§Ø¯ Ù…Ø­Ø¸ÙˆØ±Ø©','legal.distance':'Ø§Ù„Ø¨ÙŠØ¹ Ø¹Ù† Ø¨ÙØ¹Ø¯','legal.preinfo':'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£ÙˆÙ„ÙŠØ©','legal.delivery':'Ø§Ù„ØªØ³Ù„ÙŠÙ…/Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹','legal.contact':'Ø§ØªØµØ§Ù„',
          'listing.title':'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†','seller.verified':'Ù…ÙˆØ«Ù‘Ù‚','seller.default':'Ø§Ù„Ø¨Ø§Ø¦Ø¹','ribbon.showcase':'Ù…Ù…ÙŠÙ‘Ø²'}
    };

    let currentLang = localStorage.getItem('ue_lang') || 'tr';
    // --- paylaÅŸÄ±lan durum / API ---
window.UE = window.UE || {};
window.UE.I18N = I18N;
window.UE.getLang = () => currentLang;
window.UE.setLang = (lang) => {
  currentLang = lang;
  localStorage.setItem('ue_lang', lang);
  window.dispatchEvent(new CustomEvent('ue:lang', { detail: lang }));
};
    function t(key, vars){
      const dict = I18N[currentLang] || I18N.tr;
      let val = dict[key] ?? I18N.tr[key] ?? key;
      if (vars && typeof val === 'string'){
        Object.entries(vars).forEach(([k,v])=>{ val = val.replace(`{${k}}`, v); });
      }
      return val;
    }

    // ===== i18n â€“ Kategori/SÃ¶zlÃ¼kleri (SENDE NE VARSA AYNEN KALSIN) =====
const CAT_I18N = { /* ... (deÄŸiÅŸmedi) ... */ };

function applyI18n(lang) {
  currentLang = lang;
  window.UE?.setLang?.(lang);
  const dict = I18N[lang] || I18N.tr;

  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (dict[key] != null) el.innerHTML = dict[key];
  });

  document.title = dict['app.title'] || document.title;
  document.documentElement.lang = lang;
  document.documentElement.dir = (lang === 'ar') ? 'rtl' : 'ltr';

  // Placeholder metinleri
  document.getElementById('li_email')?.setAttribute('placeholder',
    lang === 'en' ? 'name@example.com' :
    lang === 'de' ? 'name@beispiel.de' :
    lang === 'ar' ? 'name@example.com' :
    'ornek@mail.com');

  document.getElementById('su_email')?.setAttribute('placeholder',
    lang === 'en' ? 'name@example.com' :
    lang === 'de' ? 'name@beispiel.de' :
    lang === 'ar' ? 'name@example.com' :
    'ornek@mail.com');

  document.getElementById('su_username')?.setAttribute('placeholder',
    lang === 'en' ? '@username' :
    lang === 'de' ? '@benutzer' :
    lang === 'ar' ? '@username' :
    '@kullanici');

  document.getElementById('su_name')?.setAttribute('placeholder',
    lang === 'en' ? 'Your full name' :
    lang === 'de' ? 'VollstÃ¤ndiger Name' :
    lang === 'ar' ? 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„' :
    'AdÄ±nÄ±z SoyadÄ±nÄ±z');

  document.getElementById('su_district')?.setAttribute('placeholder',
    lang === 'en' ? 'Your district' :
    lang === 'de' ? 'Bezirk' :
    lang === 'ar' ? 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©' :
    'Ä°lÃ§eniz');

  buildTopCats(lang);
}

// YÄ±l ve il listesi
document.getElementById('y').textContent = new Date().getFullYear();

const PROVINCES = [
  "Adana","AdÄ±yaman","Afyonkarahisar","AÄŸrÄ±","Aksaray","Amasya","Ankara","Antalya","Ardahan",
  "Artvin","AydÄ±n","BalÄ±kesir","BartÄ±n","Batman","Bayburt","Bilecik","BingÃ¶l","Bitlis","Bolu",
  "Burdur","Bursa","Ã‡anakkale","Ã‡ankÄ±rÄ±","Ã‡orum","Denizli","DiyarbakÄ±r","DÃ¼zce","Edirne","ElazÄ±ÄŸ",
  "Erzincan","Erzurum","EskiÅŸehir","Gaziantep","Giresun","GÃ¼mÃ¼ÅŸhane","Hakkari","Hatay","IÄŸdÄ±r",
  "Isparta","Ä°stanbul","Ä°zmir","KahramanmaraÅŸ","KarabÃ¼k","Karaman","Kars","Kastamonu","Kayseri",
  "KÄ±rÄ±kkale","KÄ±rklareli","KÄ±rÅŸehir","Kilis","Kocaeli","Konya","KÃ¼tahya","Malatya","Manisa",
  "Mardin","Mersin","MuÄŸla","MuÅŸ","NevÅŸehir","NiÄŸde","Ordu","Osmaniye","Rize","Sakarya","Samsun",
  "Siirt","Sinop","Sivas","ÅanlÄ±urfa","ÅÄ±rnak","TekirdaÄŸ","Tokat","Trabzon","Tunceli","UÅŸak",
  "Van","Yalova","Yozgat","Zonguldak"
].sort((a, b) => a.localeCompare(b, 'tr'));

const suProv = document.getElementById('su_province');
if (suProv) {
  suProv.innerHTML =
    '<option value="" disabled selected>Ä°l seÃ§iniz</option>' +
    PROVINCES.map(p => `<option value="${p}">${p}</option>`).join('');
}

    /* ===== KATEGORÄ°LER â€“ SENÄ°N DOSYANDAN AYNEN ===== */
    const CATS = [ /* ... (deÄŸiÅŸmedi) ... */ ];

    const catBar = document.querySelector('#catNav .catnav-inner');
    const drops = document.querySelector('#catDrops .catdrops-inner');

    function localizeCat(cat, lang){
      const L = CAT_I18N[lang] || CAT_I18N.tr || {titles:{},subs:{}};
      const title = (L.titles && L.titles[cat.id]) || cat.title || cat.id;
      const subs = (cat.subs||[]).map(([sid, sLabel])=>[sid, (L.subs && L.subs[sid]) || sLabel || sid]);
      return { id: cat.id, title, subs };
    }

    function buildTopCats(lang){
      const current = lang || (localStorage.getItem('ue_lang') || 'tr');
      catBar.innerHTML = '';
      drops.innerHTML = '';
      (CATS||[]).forEach((cat)=>{
        const LCat = localizeCat(cat, current);
        const chip = document.createElement('button');
        chip.className = 'chip';
        chip.type = 'button';
        chip.textContent = LCat.title;
        chip.dataset.target = `p_${LCat.id}`;

        const panel = document.createElement('div');
        panel.className = 'panel';
        panel.id = `p_${LCat.id}`;
        panel.innerHTML = LCat.subs.map(([id,label])=>`<a href="#" data-open-auth style="display:inline-block;margin:4px 6px;padding:8px 10px;border-radius:8px;border:1px solid #eee">${label}</a>`).join('');
        panel.addEventListener('click',(e)=>{ if(e.target.matches('a[data-open-auth]')){ e.preventDefault(); openAuth(); }});

        chip.addEventListener('click',()=>{
          const wasOpen = panel.classList.contains('open');
          document.querySelectorAll('.catdrops .panel.open').forEach(p=>p.classList.remove('open'));
          document.querySelectorAll('#catNav .chip.active').forEach(c=>c.classList.remove('active'));
          if (!wasOpen){
            panel.classList.add('open');
            chip.classList.add('active');
          }
        });

        catBar.appendChild(chip);
        drops.appendChild(panel);
      });
    }

    buildTopCats(localStorage.getItem('ue_lang')||'tr');

    const authModal = document.getElementById('authModal');

function openAuth(){
  if (authModal && typeof authModal.showModal === 'function'){
    authModal.showModal();
  } else if (authModal) {
    authModal.setAttribute('open','');
    authModal.style.display = 'grid';
  }
}

window.openAuth = openAuth; // diÄŸer scriptler iÃ§in global eriÅŸim

   function closeAuth(){
  if (typeof authModal.close === 'function') authModal.close();
}

document.querySelectorAll('#authModal [data-close]')
  .forEach(b => b.addEventListener('click', closeAuth));

document.getElementById('signInBtn')
  ?.addEventListener('click', openAuth);


    const langSel = document.getElementById('langSel');
    langSel?.addEventListener('change', (e)=>{
      const v = e.target.value;
      localStorage.setItem('ue_lang', v);
      applyI18n(v);
      // liste/iÃ§erik metinlerini gÃ¼ncelle
      if (typeof render === 'function') render();
    });
    applyI18n(localStorage.getItem('ue_lang')||'tr');

    document.querySelectorAll('.toggle').forEach(b=>b.addEventListener('click',()=>{
      const id = b.getAttribute('data-toggle'); const inp = document.getElementById(id);
      if (inp) inp.type = inp.type === 'password' ? 'text' : 'password';
    }));

    const auth = getAuth();
    const provider = new GoogleAuthProvider();

    function redirectHome(){ window.location.href = '/home.html'; }

   document.getElementById('googleBtn')?.addEventListener('click', async ()=>{
  try {
    await signInWithPopup(auth, provider);
await saveUserProfile(auth.currentUser, {});
redirectHome();
  } catch(err) {
    const msg = currentLang === 'en'
      ? 'Google sign-in failed. Please try again.'
      : 'Google ile giriÅŸ baÅŸarÄ±sÄ±z oldu. LÃ¼tfen tekrar deneyin.';
    alert(msg);
  }
});

    document.getElementById('loginBtn')?.addEventListener('click', async ()=>{
  const email = document.getElementById('li_email').value.trim();
  const pass  = document.getElementById('li_pass').value;

  if(!email || pass.length < 6){
    alert(currentLang==='en'
      ? 'Check email & password.'
      : 'E-posta ve ÅŸifreyi kontrol edin.');
    return;
  }

  try {
    const cred = await signInWithEmailAndPassword(auth, email, pass);
    await cred.user.reload();

    if (!cred.user.emailVerified){
      try { await sendEmailVerification(cred.user); } catch {}
      await saveUserProfile(cred.user, { username, name, province, district });
      alert(currentLang==='en'
         ? 'Please verify your email before continuing. We sent you a verification email.'
    : 'Devam etmeden Ã¶nce e-postanÄ±zÄ± doÄŸrulayÄ±n. Spam kutunuzu kontrol etmeyi unutmayÄ±n. DoÄŸrulama e-postasÄ± gÃ¶nderildi.');
    return; // doÄŸrulanmadan iÃ§eri alma
    }

    redirectHome(); // yalnÄ±z doÄŸrulanmÄ±ÅŸsa
  } catch(err){
  let msgTr;
  switch (err.code) {
    case 'auth/email-already-in-use':
      msgTr = 'Bu e-posta adresiyle zaten bir hesap mevcut. LÃ¼tfen giriÅŸ yapÄ±n.';
      break;
    case 'auth/invalid-email':
      msgTr = 'GeÃ§ersiz e-posta adresi.';
      break;
    case 'auth/user-not-found':
      msgTr = 'Bu e-posta adresiyle kayÄ±tlÄ± kullanÄ±cÄ± bulunamadÄ±.';
      break;
    case 'auth/wrong-password':
      msgTr = 'Åifre yanlÄ±ÅŸ. LÃ¼tfen tekrar deneyin.';
      break;
      case 'auth/wrong-password':
  msgTr = 'Åifre yanlÄ±ÅŸ. LÃ¼tfen tekrar deneyin.';
  break;
case 'auth/invalid-credential':
case 'auth/invalid-login-credentials':
  msgTr = 'E-posta veya ÅŸifre hatalÄ±.';
  break;
    case 'auth/missing-password':
      msgTr = 'LÃ¼tfen bir ÅŸifre girin.';
      break;
    default:
      msgTr = 'Bir hata oluÅŸtu: ' + (err.message || err.code);
  }
  alert(msgTr);
}
});

    document.getElementById('forgotBtn')?.addEventListener('click', async ()=>{
      const email = document.getElementById('li_email').value.trim();
      if(!email){ alert(currentLang==='en'?'Enter your email to reset password.':'Åifre sÄ±fÄ±rlamak iÃ§in e-posta girin.'); return; }
      try{ await sendPasswordResetEmail(auth, email); alert(currentLang==='en'?'Password reset email sent. Check inbox/SPAM.':'Åifre sÄ±fÄ±rlama e-postasÄ± gÃ¶nderildi. Gelen kutusu ve SPAM klasÃ¶rÃ¼nÃ¼ kontrol edin.'); }
      catch(err){
  let msgTr;
  switch (err.code) {
    case 'auth/user-not-found':
      msgTr = 'Bu e-posta adresiyle kayÄ±tlÄ± kullanÄ±cÄ± bulunamadÄ±.';
      break;
    case 'auth/invalid-email':
      msgTr = 'GeÃ§ersiz e-posta adresi.';
      break;
    case 'auth/too-many-requests':
      msgTr = 'Ã‡ok fazla deneme yapÄ±ldÄ±. LÃ¼tfen daha sonra tekrar deneyin.';
      break;
    case 'auth/network-request-failed':
      msgTr = 'AÄŸ hatasÄ± oluÅŸtu. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.';
      break;
    default:
      msgTr = 'Bir hata oluÅŸtu: ' + (err.message || err.code);
  }
  alert(msgTr);
}
    });

    document.getElementById('registerBtn')?.addEventListener('click', async ()=>{
  const username = document.getElementById('su_username').value.trim();
  const name     = document.getElementById('su_name').value.trim();
  const province = document.getElementById('su_province').value;
  const district = document.getElementById('su_district').value.trim();
  const email    = document.getElementById('su_email').value.trim();
  const pass     = document.getElementById('su_pass').value;
  const pass2    = document.getElementById('su_pass2').value;

  if (!username || !name || !province || !district || !email || pass.length < 6 || pass !== pass2){
    alert(currentLang==='en' ? 'Please fill all fields correctly.' : 'LÃ¼tfen tÃ¼m alanlarÄ± doÄŸru doldurun.');
    return;
  }

  try {

    // ğŸŸ¡ E-POSTA Ã–N KONTROL
    const methods = await fetchSignInMethodsForEmail(auth, email);

    if (methods.includes('password')) {
      alert('Bu e-posta ile zaten bir hesabÄ±nÄ±z var. LÃ¼tfen giriÅŸ yapÄ±n.');
      return;
    }

    if (methods.includes('google.com')) {
      alert('Bu e-posta Google hesabÄ±nÄ±zla kayÄ±tlÄ±. LÃ¼tfen "Google ile giriÅŸ yap" ile giriÅŸ yapÄ±n.');
      return;
    }

    // ğŸŸ¢ Yeni hesap oluÅŸtur
    const cred = await createUserWithEmailAndPassword(auth, email, pass);
    await updateProfile(cred.user, { displayName: name });



    // DoÄŸrulama e-postasÄ± gÃ¶nder
    try { await sendEmailVerification(cred.user); } catch {}
    await saveUserProfile(cred.user, { username, name, province, district });

    // KullanÄ±cÄ±yÄ± iÃ§eri almÄ±yoruz; doÄŸrulama zorunlu
    alert(currentLang==='en'
      ? 'Registration completed. Please verify your email. Check Inbox/SPAM.'
      : 'KayÄ±t tamamlandÄ±. LÃ¼tfen e-postanÄ±zÄ± doÄŸrulayÄ±n. Gelen kutusu/Spam klasÃ¶rÃ¼nÃ¼ kontrol edin.');

    // Oturumu kapat ki doÄŸrulanmadan /home.htmlâ€™a geÃ§emesin
    try { await signOut(auth); } catch {}

    // Ä°stersen giriÅŸ modali aÃ§Ä±k kalsÄ±n; yÃ¶nlendirme YOK.
    // redirectHome();  â† kaldÄ±rÄ±ldÄ±

  }catch(err){
  let msgTr;
  switch (err.code) {
    case 'auth/email-already-in-use':
      msgTr = 'Bu e-posta adresiyle zaten bir hesap mevcut. LÃ¼tfen giriÅŸ yapÄ±n.';
      break;
    case 'auth/invalid-email':
      msgTr = 'GeÃ§ersiz e-posta adresi.';
      break;
    case 'auth/weak-password':
      msgTr = 'Åifre en az 6 karakter olmalÄ±.';
      break;
    case 'auth/operation-not-allowed':
      msgTr = 'Bu kayÄ±t yÃ¶ntemi ÅŸu anda izinli deÄŸil. LÃ¼tfen daha sonra tekrar deneyin.';
      break;
    case 'auth/network-request-failed':
      msgTr = 'AÄŸ hatasÄ± oluÅŸtu. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin.';
      break;
    case 'auth/too-many-requests':
      msgTr = 'Ã‡ok fazla deneme yapÄ±ldÄ±. LÃ¼tfen kÄ±sa bir sÃ¼re sonra tekrar deneyin.';
      break;
    default:
      msgTr = 'Bir hata oluÅŸtu: ' + (err.message || err.code);
  }
  alert(msgTr);
}
});

    onAuthStateChanged(auth, (u)=>{
      const authArea = document.getElementById('authArea');
      const signBtn = document.getElementById('signInBtn');
      if (u){
        authArea.style.display='flex'; signBtn.style.display='none';
        document.getElementById('uName').textContent = u.displayName || u.email || (I18N[currentLang]['seller.default']||'SatÄ±cÄ±');
        document.getElementById('uAvatar').src = u.photoURL || '/assets/img/avatar-default.png';
      } else {
        authArea.style.display='none'; signBtn.style.display='inline-flex';
      }
    });

    document.getElementById('signOutBtn')?.addEventListener('click', async ()=>{ try{ await signOut(auth); }catch{} });
document.getElementById('browseBtn')?.addEventListener('click', () => {
  location.href = '/listings.html';
});

    document.getElementById('postBtn')?.addEventListener('click', openAuth);
  </script>

  <script type="module">
    import { getFirestore, collection, getDocs, orderBy, query } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js';
    
    // paylaÅŸÄ±lan sÃ¶zlÃ¼k ve dil
const I18N = (window.UE && window.UE.I18N) || {};
let currentLang = (window.UE && window.UE.getLang && window.UE.getLang()) || localStorage.getItem('ue_lang') || 'tr';

// dil deÄŸiÅŸince listeyi yeniden Ã§iz
window.addEventListener('ue:lang', (e)=>{
  currentLang = e.detail || 'tr';
  render?.();
});


    const db2 = (self.__fb?.db) || getFirestore();
    const grid = document.getElementById('listGrid');
    const info = document.getElementById('listInfo');
    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');

    const PAGE_SIZE = 40;
    let allListings = [];
    let page = 0;

    function formatPrice(tryAmount){
      try{
        const locale = currentLang==='de'?'de-DE':(currentLang==='en'?'en-US':(currentLang==='ar'?'ar-EG':'tr-TR'));
        return new Intl.NumberFormat(locale,{style:'currency',currency:'TRY',maximumFractionDigits:0}).format(tryAmount);
      }catch{ return tryAmount + ' TL'; }
    }
  
// ğŸ”§ Ä°LAN KARTI: satÄ±cÄ± adÄ± + avatar eklenmiÅŸ ÅŸablon (profil fallback'lÄ±)
async function cardTpl(it){
  const imgList  = Array.isArray(it.photos) ? it.photos : [];
  const mainImg  = clMain(imgList[0]);
  const showcase = !!it.showcase;

  // YENÄ°
const priceTxt = (typeof it.price === 'number')
  ? formatPrice(it.price)
  : '';

  const title = (it.title || 'â€”').toString();
  const id    = it.id;

  // --- SatÄ±cÄ± profilini gerektiÄŸinde getir ---
  let prof = it.__sellerProfile || null;
  if (!it.sellerDisplayName && !it.sellerAvatarPublicId && !it.sellerAvatarUrl) {
    const uid = it.ownerUid || it.userId || it.uid || it.owner || it.sellerUid || null;
    if (uid && typeof self.getUserProfile === 'function') {
      try {
        prof = await self.getUserProfile(uid);
        it.__sellerProfile = prof || null; // sonraki kartlarda tekrar Ã§ekmesin
      } catch(e){ console.warn('[cardTpl] profil okunamadÄ±:', uid, e); }
    }
  }

  // --- Ad & Avatar Ã§Ã¶zÃ¼mleme (ilan + profil birleÅŸtir) ---
  let name = null, avatarPid = null, avatarUrl = null;
  if (typeof self.resolveSellerFields === 'function') {
    const resolved = self.resolveSellerFields(it, prof || {});
    name = resolved?.name || null;
    avatarPid = resolved?.avatarPid || null;
    avatarUrl = resolved?.avatarUrl || null;
  } else {
    // emniyetli fallback (resolveSellerFields yoksa)
    name =
      it.sellerDisplayName || it.sellerName || it.ownerName || it.username || it.name ||
      prof?.displayName || prof?.fullName || prof?.name || prof?.username || null;

    avatarPid =
      it.sellerAvatarPublicId || it.avatarPublicId || it.photoPublicId || it.avatarId || it.avatarPid ||
      prof?.sellerAvatarPublicId || prof?.avatarPublicId || prof?.photoPublicId || prof?.avatarPid || null;

    avatarUrl =
      it.sellerAvatarUrl || it.photoURL || it.avatarUrl ||
      prof?.sellerAvatarUrl || prof?.photoURL || prof?.avatarUrl || null;
  }

  const finalName = (name && String(name).trim()) || (window.UE?.I18N?.tr?.['seller.default'] || 'SatÄ±cÄ±');
  const finalAvatar =
    avatarPid ? (self.avatarUrl ? self.avatarUrl(avatarPid) : '') :
    avatarUrl ? (self.fetchThumb ? self.fetchThumb(avatarUrl) : avatarUrl) :
    'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIzMiIgY3k9IjMyIiByPSIzMiIgZmlsbD0iI2VlZWVlZSIvPjxjaXJjbGUgY3g9IjMyIiBjeT0iMjIiIHI9IjExIiBmaWxsPSIjY2NjY2NjIi8+PHBhdGggZD0iTTMyIDM2Yy0xNiAwLTIyIDguNy0yMiAxMy4zIDAgMS44IDEuNSAzLjMgMy4zIDMuM2gzNy40YzEuOCAwIDMuMy0xLjUgMy4zLTMuMyAwLTQuNi02LTEzLjMtMjItMTMuM3oiIGZpbGw9IiNjY2NjY2MiLz48L3N2Zz4=';

  return `
    <article class="card" data-id="${id ?? ''}">
      <div class="ph">
        ${showcase ? `<span class="ribbon">${(I18N?.[currentLang]?.['ribbon.showcase'] || I18N?.tr?.['ribbon.showcase'] || 'Vitrin')}</span>` : ''}
        <img alt="${title}" loading="lazy" src="${mainImg}" width="800" height="550">
      </div>
      <div class="body">
        <div class="title">${title}</div>
        <div class="seller">
          <div class="av"><img alt="${finalName}" src="${finalAvatar}" width="22" height="22" style="border-radius:50%"></div>
          <div class="name" title="${finalName}">${finalName}</div>
        </div>
        <div class="price">${priceTxt}</div>
      </div>
    </article>`;
}

    // === REPLACE: async function fetchSeller(uid){ ... } ===
async function fetchSeller(uid){
  if (!uid) return null;
  try {
    const { getDoc, doc } = await import('https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js');
    // Ana koleksiyon
    let snap = await getDoc(doc(db2, 'users', uid));
    if (snap.exists()) return { _src: 'users', ...snap.data() };

    // Alternatif koleksiyon isimleri (bazÄ± projelerde farklÄ± olabiliyor)
    const altPaths = [
      ['profiles', uid],
      ['userProfiles', uid],
    ];
    for (const [col, id] of altPaths) {
      try {
        const s2 = await getDoc(doc(db2, col, id));
        if (s2.exists()) return { _src: col, ...s2.data() };
      } catch {}
    }
  } catch (_) {
    // Yetki yok / offline / baÅŸka hata â€” sessizce geÃ§
    return null;
  }
  return null;
}

    function setListInfo(start, end, total){
      const txt = (I18N[currentLang]['list.range']||'{start}-{end} / {total}')
        .replace('{start}', start).replace('{end}', end).replace('{total}', total);
      info.textContent = txt;
    }

    // ---- Cloudinary yardÄ±mcÄ±larÄ± (firebase-init.js global fonksiyonlarÄ±nÄ± kullanÄ±r) ----
const EMPTY_IMG = 'data:image/gif;base64,R0lGODlhAQABAAAAACw=';

function clMain(src){
  if (!src) return EMPTY_IMG;
  // Tam Cloudinary URL geldiyse (hangi cloud name olursa olsun) olduÄŸu gibi kullan:
  if (/^https?:\/\/res\.cloudinary\.com\//.test(src)) return src;
  // BaÅŸka bir tam URL ise de fetch yapma, direkt gÃ¶ster:
  if (/^https?:\/\//.test(src)) return src;
  // Public ID ise kendi cloud'unda Ã¼ret:
  return (window.clUrl?.(src, { c:'fill', w:800, h:550, q:'auto', f:'auto' }) || src);
}

function clThumb(src){
  if (!src) return EMPTY_IMG;
  // Tam Cloudinary URL geldiyse direkt kullan:
  if (/^https?:\/\/res\.cloudinary\.com\//.test(src)) return src;
  // BaÅŸka bir tam URL ise de fetch yapma:
  if (/^https?:\/\//.test(src)) return src;
  // Public ID ise kendi cloud'unda kÃ¼Ã§Ã¼k gÃ¶rsel Ã¼ret:
  return (window.clUrl?.(src, { c:'fill', w:120, h:120, q:'auto', f:'auto' }) || src);
}

function avatarFromSeller(s){
  const publicId = s?.avatarPublicId || s?.photoPublicId || s?.avatarId || s?.avatarPid;
  const url      = s?.sellerAvatarUrl || s?.photoURL || s?.avatarUrl;

  if (publicId && window.avatarUrl) return window.avatarUrl(publicId);

  if (url){
    // Cloudinary tam URL ise direkt kullan
    if (/^https?:\/\/res\.cloudinary\.com\//.test(url)) return url;
    // DiÄŸer tam URL'ler iÃ§in istersen kÄ±rp/fetch
    return window.clFetch?.(url, { c:'fill', w:60, h:60, q:'auto', f:'auto', radius:'max' }) || url;
  }

  return EMPTY_IMG;
}

    async function render(){
  const start = page * PAGE_SIZE;
  const slice = allListings.slice(start, start + PAGE_SIZE);
  const htmlArr = await Promise.all(slice.map(cardTpl)); // â† Promiseleri bekle
  grid.innerHTML = htmlArr.join('');
  setListInfo(allListings.length ? (start + 1) : 0, Math.min(start + PAGE_SIZE, allListings.length), allListings.length);
  prevBtn.disabled = page === 0;
  nextBtn.disabled = (start + PAGE_SIZE) >= allListings.length;
  prevBtn.textContent = I18N[currentLang]['buttons.prev'] || 'â€¹ Ã–nceki';
  nextBtn.textContent = I18N[currentLang]['buttons.next'] || 'Sonraki â€º';
}

    grid.addEventListener('click', async (e) => {
  const card = e.target.closest('.card');
  if (!card) return;
  const id = card.getAttribute('data-id');
  const listing = allListings.find(x => x.id === id);
  if (!listing) return;

  // "SipariÅŸ" veya "Mesaj" butonuna basÄ±ldÄ±ysa
  if (e.target.matches('[data-do="order"], [data-do="msg"]')) {
    const { getAuth } = await import('https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js');
    const auth = getAuth();
    const user = auth.currentUser;
    if (!user) {
      alert('GiriÅŸ yapmalÄ±sÄ±nÄ±z.');
      window.openAuth?.(); // giriÅŸ panelini aÃ§
      return;
    }
    // GiriÅŸ yapÄ±lmÄ±ÅŸsa satÄ±cÄ± bilgilerini gÃ¶ster (veya ileride iÅŸlem yapÄ±labilir)
  }

  // KartÄ±n baÅŸka yerine tÄ±klanÄ±rsa detay modalÄ±nÄ± aÃ§
openListingDetail(listing, card.querySelector('.ph img')?.src);
}); 

// === REPLACE: async function openListingDetail(it, imgSrc){ ... } ===
async function openListingDetail(it, imgSrc) {
  const modal = document.getElementById('listingModal');
  const body  = document.getElementById('listingBody');

  // â€”â€”â€” SatÄ±cÄ± adÄ± (sadece ilan dokÃ¼manÄ±ndan) â€”â€”â€”
  const sName =
    (it.sellerDisplayName || it.sellerName || it.ownerName || it.username || it.name || '').toString().trim() ||
    (I18N?.[UE?.getLang?.() || 'tr']?.['seller.default'] || I18N?.tr?.['seller.default'] || 'SatÄ±cÄ±');

  // â€”â€”â€” Avatar (Cloudinary PID > Cloudinary upload URL > http URL > Storage path > inline SVG) â€”â€”â€”
const p = it.__sellerProfile || {};

let pidFromDoc =
  it.sellerAvatarPublicId || it.avatarPublicId || it.photoPublicId || it.avatarId || it.avatarPid ||
  p.sellerAvatarPublicId || p.avatarPublicId || p.photoPublicId || p.avatarPid ||
  (p.photos && (p.photos.avatarPublicId || p.photos.avatarPid)) || null;

let urlFromDoc =
  it.sellerAvatarUrl || it.photoURL || it.avatarUrl || it.avatar ||
  p.sellerAvatarUrl || p.photoURL || p.avatarUrl || p.avatar || null;

// 1) Site asset yoluysa (assets/...) mutlak yap
if (urlFromDoc && /^\/?assets\//i.test(urlFromDoc)) {
  urlFromDoc = `${location.origin}/${urlFromDoc.replace(/^\//,'')}`;
}

// 2) Storage path ise (http deÄŸil ve assets/ deÄŸil) downloadURL'e Ã§evir
if (
  urlFromDoc &&
  !/^https?:\/\//i.test(urlFromDoc) &&
  !/^\/?assets\//i.test(urlFromDoc) &&
  self.storageRef && self._getDownloadURL
) {
  try {
    const refObj = self.storageRef(urlFromDoc);
    urlFromDoc = await self._getDownloadURL(refObj);
  } catch { urlFromDoc = null; }
}

let sAv = '';
try {
  if (pidFromDoc && (self.avatarUrl || window.avatarUrl)) {
    // Cloudinary public_id iÃ§in dÃ¶nÃ¼ÅŸtÃ¼rÃ¼lmÃ¼ÅŸ avatar
    const makePidUrl = self.avatarUrl || window.avatarUrl;
    sAv = makePidUrl(pidFromDoc);
  } else if (urlFromDoc) {
    const cloud = (self.CLOUDINARY && self.CLOUDINARY.cloud) || 'dbntnzogo';
    const reClUpload = new RegExp(`^https?://res\\.cloudinary\\.com/${cloud}/image/upload/`);
    const tx = 'c_fill,w_60,h_60,r_max,q_auto,f_auto';

    if (reClUpload.test(urlFromDoc)) {
      // Cloudinary UPLOAD URL'Ã¼ ise FETCH kullanma â€” transformu /upload/ sonrasÄ±na enjekte et
      sAv = urlFromDoc.replace('/image/upload/', `/image/upload/${tx}/`);
    } else {
      // Normal http(s) URL â€” varsa Cloudinary fetch ile dÃ¶nÃ¼ÅŸtÃ¼r
      const clFetchFn = self.clFetch || window.clFetch;
      sAv = clFetchFn
        ? clFetchFn(urlFromDoc, { c:'fill', w:60, h:60, q:'auto', f:'auto', radius:'max' })
        : urlFromDoc;
    }
  } else {
    // inline SVG placeholder (dosyaya gerek yok)
    sAv = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIzMiIgY3k9IjMyIiByPSIzMiIgZmlsbD0iI2VlZWVlZSIvPjxjaXJjbGUgY3g9IjMyIiBjeT0iMjIiIHI9IjExIiBmaWxsPSIjY2NjY2NjIi8+PHBhdGggZD0iTTMyIDM2Yy0xNiAwLTIyIDguNy0yMiAxMy4zIDAgMS44IDEuNSAzLjMgMy4zIDMuM2gzNy40YzEuOCAwIDMuMy0xLjUgMy4zLTMuMyAwLTQuNi02LTEzLjMtMjItMTMuM3oiIGZpbGw9IiNjY2NjY2MiLz48L3N2Zz4=';
  }
} catch {
  sAv = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIzMiIgY3k9IjMyIiByPSIzMiIgZmlsbD0iI2VlZWVlZSIvPjxjaXJjbGUgY3g9IjMyIiBjeT0iMjIiIHI9IjExIiBmaWxsPSIjY2NjY2NjIi8+PHBhdGggZD0iTTMyIDM2Yy0xNiAwLTIyIDguNy0yMiAxMy4zIDAgMS44IDEuNSAzLjMgMy4zIDMuM2gzNy40YzEuOCAwIDMuMy0xLjUgMy4zLTMuMyAwLTQuNi02LTEzLjMtMjItMTMuM3oiIGZpbGw9IiNjY2NjY2MiLz48L3N2Zz4=';
}

// <img src="${sAv}">

  // â€”â€”â€” Konum (varsa ilan iÃ§inden) â€”â€”â€”
  const city = it.province || it.city || it.sehir || '';
  const dist = it.district || it.ilce  || '';
  const loc  = city ? (dist ? `${city} / ${dist}` : city) : '';

  // â€”â€”â€” DoÄŸrulanmÄ±ÅŸ satÄ±cÄ± bayraÄŸÄ± (ilan iÃ§i Ã§eÅŸitli alan adlarÄ±) â€”â€”â€”
  const verified = !!(it.sellerVerified || it.verifiedSeller || it.verified || it.isVerified);

  // â€”â€”â€” Fiyat â€”â€”â€”
  const price = (typeof it.price === 'number')
    ? formatPrice(it.price)
    : '';

  // â€”â€”â€” Kapak gÃ¶rseli â€”â€”â€”
  const coverSrc = imgSrc || (Array.isArray(it.photos) ? clMain(it.photos[0]) : '') || '';

  // â€”â€”â€” Ä°Ã§erik â€”â€”â€”
  body.innerHTML = `
    <div style="display:grid;gap:12px">
      <div style="border-radius:14px;overflow:hidden;border:1px solid #eee">
        <img src="${coverSrc}" alt="${it.title || ''}" style="width:100%;height:auto;display:block" width="1200" height="825">
      </div>

      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
        <div class="av" style="width:34px;height:34px">
          <img src="${sAv}" alt="${sName}" width="34" height="34" style="border-radius:50%">
        </div>
        <div style="font-weight:700">
          ${sName}${loc ? ` Â· <span style="color:#6b7280">${loc}</span>` : ''}
        </div>
        ${verified ? `<span class="badge">${(I18N?.[UE?.getLang?.() || 'tr']?.['seller.verified'] || I18N?.tr?.['seller.verified'] || 'OnaylÄ±')}</span>` : ''}
      </div>

      <div>
        <div style="font-size:20px;font-weight:900">${it.title || ''}</div>
        <div style="color:#6b7280;margin-top:6px">${it.description || ''}</div>
      </div>

      <div style="font-size:18px;font-weight:900">${price}</div>

      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn gold"  id="detailOrder">${(I18N?.[UE?.getLang?.() || 'tr']?.['buttons.order']   || I18N?.tr?.['buttons.order']   || 'SipariÅŸ Ver')}</button>
        <button class="btn ghost" id="detailMsg">${(I18N?.[UE?.getLang?.() || 'tr']?.['buttons.message'] || I18N?.tr?.['buttons.message'] || 'SatÄ±cÄ±ya Yaz')}</button>
      </div>
    </div>`;

  document.getElementById('detailOrder')?.addEventListener('click', () => window.openAuth?.());
  document.getElementById('detailMsg')  ?.addEventListener('click', () => window.openAuth?.());

  if (typeof modal.showModal === 'function') modal.showModal();
  else { modal.setAttribute('open',''); modal.style.display='grid'; }
}

    document.querySelector('[data-close-listing]')?.addEventListener('click',()=>{
  const modal = document.getElementById('listingModal');
  if (typeof modal.close === 'function') modal.close();
});

    prevBtn.addEventListener('click',()=>{ if(page>0){ page--; render(); }});
    nextBtn.addEventListener('click',()=>{ if((page+1)*PAGE_SIZE < allListings.length){ page++; render(); }});

    async function loadListings() {
  try {
    // GÃ¼venli I18N kontrolÃ¼
    const dict = I18N?.[currentLang] || I18N?.tr || {};
    info.textContent = dict['list.loading'] || 'YÃ¼kleniyorâ€¦';

    const colRef = collection(db2, 'listings');
    const q = query(colRef, orderBy('updatedAt', 'desc'));
    const snap = await getDocs(q);

    const now = Date.now();
    const rows = [];

    snap.forEach(docSnap => {
      const data = docSnap.data();
      if (data?.status === 'approved') {
        const exp = data?.expiresAt?.toDate
          ? data.expiresAt.toDate().getTime()
          : (data?.expiresAt ? new Date(data.expiresAt).getTime() : now + 1);
        if (exp >= now) {
          rows.push({ id: docSnap.id, ...data });
        }
      }
    });

    const showcase = rows.filter(r => !!r.showcase);
    const standard = rows.filter(r => !r.showcase);
    allListings = [...showcase, ...standard];
    page = 0;
    render();
  } catch (err) {
    info.textContent = currentLang === 'en'
      ? 'Failed to load listings'
      : 'Ä°lanlar yÃ¼klenemedi';
    console.error(err);
  }
}

// Firebase hazÄ±r olduÄŸunda Ã§alÄ±ÅŸtÄ±r
if (self.__fbReady) {
  loadListings();
} else {
  document.addEventListener('fb-ready', loadListings, { once: true });
}

// dil deÄŸiÅŸirse liste metinlerini yenile
window.addEventListener('storage', (e)=>{
  if(e.key === 'ue_lang'){
    currentLang = localStorage.getItem('ue_lang') || 'tr';
    render();
  }
});
</script>
<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Firebase config ve init -->
<script src="firebase-init.js"></script>

<script>
  document.getElementById("langSelect").addEventListener("change", function () {
    const lang = this.value;
    localStorage.setItem("lang", lang);
    applyLanguage(lang);
  });

  const saved = localStorage.getItem("lang") || "tr";
  document.getElementById("langSelect").value = saved;
  applyLanguage(saved);
<script>
    const showcase = rows.filter(r => !!r.showcase);
    const standard = rows.filter(r => !r.showcase);
    allListings = [...showcase, ...standard];
    page = 0;
    render();
  } catch (err) {
    info.textContent = currentLang === 'en'
      ? 'Failed to load listings'
      : 'Ä°lanlar yÃ¼klenemedi';
    console.error(err);
  }
}

// Firebase hazÄ±r olduÄŸunda Ã§alÄ±ÅŸtÄ±r
if (self.__fbReady) {
  loadListings();
} else {
  document.addEventListener('fb-ready', loadListings, { once: true });
}

// dil deÄŸiÅŸirse liste metinlerini yenile
window.addEventListener('storage', (e)=>{
  if(e.key === 'ue_lang'){
    currentLang = localStorage.getItem('ue_lang') || 'tr';
    render();
  }
});
</script>

<!-- ================== SIRA GECESÄ° SABÄ°T ALT BANNER ================== -->
<a href="https://xn--sragecesi-vpb.com/" target="_blank" class="sg-banner">
  <img id="sgBannerImg" src="reklam/1.jpg" alt="Urfa SÄ±ra Gecesi">
  <span id="sgBannerText">Urfa SÄ±ra Gecesi â€¢ Hayati Ä°ÅŸler</span>
</a>

<style>
.sg-banner{
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 90px;
  background: rgba(20,10,5,0.95);
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 10px 16px;
  box-sizing: border-box;
  z-index: 9998;
  text-decoration: none;
  backdrop-filter: blur(6px);
}

.sg-banner img{
  height: 70px;
  border-radius: 8px;
  object-fit: cover;
  transition: all 0.6s ease;
}

.sg-banner span{
  color: #f5e6c8;
  font-size: 15px;
  font-weight: 500;
  line-height: 1.3;
  transition: all 0.6s ease;
}

@media(max-width:768px){
  .sg-banner{
    height: 80px;
  }
  .sg-banner img{
    height: 60px;
  }
  .sg-banner span{
    font-size: 14px;
  }
}
</style>

<script>
const sgSlides = [
  { img: "1.jpg", text: "Urfa SÄ±ra Gecesi â€¢ Hayati Ä°ÅŸler" },
  { img: "2.jpg", text: "CanlÄ± MÃ¼zik â€¢ Otantik Atmosfer" },
  { img: "3.jpg", text: "TÃ¼rkÃ¼ler â€¢ Ã‡iÄŸ KÃ¶fte â€¢ Sohbet" },
  { img: "4.jpg", text: "ÅanlÄ±urfa KÃ¼ltÃ¼rÃ¼ â€¢ SÄ±ra Gecesi" }
];

let sgIndex = 0;
const sgImg = document.getElementById("sgBannerImg");
const sgText = document.getElementById("sgBannerText");

setInterval(() => {
  sgIndex = (sgIndex + 1) % sgSlides.length;

  sgImg.style.opacity = 0;
  sgText.style.opacity = 0;
  sgImg.style.transform = "translateX(-30px)";
  sgText.style.transform = "translateX(-30px)";

  setTimeout(() => {
    sgImg.src = sgSlides[sgIndex].img;
    sgText.textContent = sgSlides[sgIndex].text;

    sgImg.style.transform = "translateX(0)";
    sgText.style.transform = "translateX(0)";
    sgImg.style.opacity = 1;
    sgText.style.opacity = 1;
  }, 400);

}, 6000);
</script>
<!-- ================================================================ -->

</body>
</html>
